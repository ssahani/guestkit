{
  "$schema": "https://guestkit.dev/schemas/job-v1.json",
  "version": "1.0",
  "job_id": "job-01JAB3Y7X5K4M8F9W2T6",
  "created_at": "2026-01-30T10:00:00Z",
  "kind": "VMOperation",
  "operation": "guestkit.inspect",

  "metadata": {
    "name": "weekly-security-scan-prod-web-01",
    "namespace": "production",
    "labels": {
      "environment": "prod",
      "team": "platform",
      "cost-center": "engineering",
      "vm-type": "web-server"
    },
    "annotations": {
      "ticket": "INC-12345",
      "requested_by": "alice@company.com",
      "description": "Weekly automated security scan",
      "scan-schedule": "weekly"
    }
  },

  "execution": {
    "idempotency_key": "weekly-scan-2026-w04-prod-web-01",
    "attempt": 1,
    "max_attempts": 3,
    "timeout_seconds": 7200,
    "deadline": "2026-01-30T14:00:00Z",
    "priority": 7,
    "cancellable": true
  },

  "constraints": {
    "required_capabilities": [
      "guestkit.inspect",
      "disk.qcow2",
      "fs.ext4"
    ],
    "required_features": [
      "lvm",
      "selinux"
    ],
    "minimum_worker_version": "0.4.0",
    "maximum_disk_size_gb": 1000,
    "require_privileged": true,
    "allowed_worker_pools": ["pool-secure", "pool-prod"]
  },

  "routing": {
    "worker_pool": "pool-prod",
    "affinity": {
      "disk_locality": "/mnt/vms"
    }
  },

  "payload": {
    "type": "guestkit.inspect.v1",
    "data": {
      "image": {
        "path": "/mnt/vms/prod-web-01.qcow2",
        "format": "qcow2",
        "checksum": "sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",
        "size_bytes": 42949672960,
        "read_only": true
      },
      "options": {
        "deep_scan": true,
        "include_packages": true,
        "include_services": true,
        "include_users": true,
        "include_network": true,
        "include_security": true,
        "include_storage": true,
        "include_databases": true
      },
      "output": {
        "format": "json",
        "destination": "/mnt/output/prod-web-01-scan.json",
        "compression": null
      }
    }
  },

  "observability": {
    "trace_id": "550e8400-e29b-41d4-a716-446655440001",
    "span_id": "446655440002",
    "parent_span_id": null,
    "correlation_id": "weekly-scan-batch-2026-w04"
  },

  "audit": {
    "submitted_by": "api-service-v1.2.3",
    "submitted_from": "10.0.1.50",
    "authorization": {
      "method": "bearer_token",
      "subject": "service-account-scanner"
    }
  }
}
